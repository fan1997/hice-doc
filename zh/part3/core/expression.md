# Expression (表达式)

## 懒惰计算（特性）

```cpp
// 例2-1：不进行计算
tensor_a + tensor_b;

// 例2-2：懒惰计算
result = tensor_a + tensor_b;
```

对于任何表达式，程序首先构建一个表达式语法树，之后由赋值运算符（‘=’）触发计算。在例2-1中，程序生成了一个表达式对象，几乎不需要占用额外的内存空间，由于没有赋值运算符，不进行计算。但在例2-2中，赋值运算符会触发计算过程，并把计算结果存入等式左边的张量。



## 复合表达式

```cpp
// 例1-1：简单表达式
temp = tensor_b / tensor_c;
result = tensor_a + temp;

// 例1-2：复合表达式
result = tensor_a + tensor_b / tensor_c; 

// 例1-3：复合表达式
(result = tensor_d) = tensor_a; // 错误
```

例1-1和例1-2中的两种方式的计算效果一样。在复合表达式中，张量基础运算符的优先级与实数相应运算符的优先级等价。表达式中赋值运算符的左侧必须是一个张量，而不能是其他表达式，例1-3是一个错误示范。

注：在使用每一种运算符之前，请务必仔细阅读相应运算符的使用说明。



## 计算环境

表达式的计算可以在CPU上进行，也可以在GPU设备上进行，Hice内置了‘CPU’和‘CUDA’两个枚举变量，支持显式的指定表达式的计算环境，如例3-1和例3-2所示。

需要注意的是，在指定表达式的计算环境后，表达式右侧中所有的张量的设备信息均被改变。

```cpp
// 例3-1
result = (tensor_a + tensor_b).to(CPU);	// 将tensor_a和tensor_b的设备信息置为CPU，在CPU上计算

// 例3-2
result = (tensor_a + tensor_b).to(CUDA);// 将tensor_a和tensor_b的设备信息置为GPU，并在GPU上计算
```

若没有显式地指明计算环境，则表达式计算默认在CPU上进行。但是，为了确保程序正确的运行，显式地指定计算环境是一个很好的习惯。
